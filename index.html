<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Guide to EPF Questions</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: The SPA is designed with a task-oriented, thematic structure. Instead of a flat list, the 15 questions are grouped into four logical categories: 'Getting Started', 'Account Management', 'Money Movements', and 'Information & Claims'. This structure helps users quickly find answers related to their specific goal (e.g., managing details vs. withdrawing money). The main interaction is a tab-based navigation system. Clicking a category tab reveals the relevant questions in an accordion format. This allows users to focus on one area at a time without being overwhelmed. An introductory section provides context and a simple donut chart visualizes the distribution of questions across these themes, giving a quick overview of common user concerns. This design was chosen for its clarity, progressive disclosure of information, and ease of navigation on both desktop and mobile devices. A new section powered by the Gemini API allows users to ask free-form questions not covered in the static FAQ, adding dynamic, real-time knowledge retrieval. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Grouping of 15 EPF questions by theme. Goal: Show the thematic distribution of common user tasks. Viz/Presentation: Donut Chart (Chart.js/Canvas). Interaction: Hovering over chart segments highlights the theme and shows the count. Justification: Provides an immediate visual summary of the main areas of user interest, setting the context for the application's structure. Library: Chart.js.
        - Report Info: Individual "How To" questions and their answers. Goal: Provide clear, step-by-step answers. Viz/Presentation: Accordion List (HTML/CSS/JS). Interaction: Clicking a question expands to reveal the answer. Justification: This is a standard and highly effective UI pattern for FAQs. It keeps the interface clean and allows users to scan questions easily and dive into the details of only those they are interested in, preventing information overload. Library/Method: Vanilla JS for toggle functionality.
        - Report Info: Free-form EPF questions. Goal: Answer user questions beyond the predefined list. Viz/Presentation: Text input, a loading state, and a text output area for the answer and citations. Interaction: User types a question and clicks a button to get a response from the Gemini API. Justification: This adds a dynamic, powerful, and highly useful feature that enhances the app's utility significantly by offering real-time, grounded information. Library/Method: Gemini API via Fetch. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4A4A4A;
        }
        .tab-active {
            border-bottom-color: #C0A080;
            color: #A07D5A;
            font-weight: 600;
        }
        .tab-inactive {
            border-bottom-color: transparent;
            color: #7a7a7a;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .accordion-item.open .accordion-content {
            max-height: 1000px;
            transition: max-height 0.5s ease-in;
        }
        .accordion-arrow {
            transition: transform 0.3s ease;
        }
        .accordion-item.open .accordion-arrow {
            transform: rotate(180deg);
        }
        .chart-container {
            position: relative; 
            width: 100%; 
            max-width: 350px; 
            margin-left: auto; 
            margin-right: auto; 
            height: 300px; 
            max-height: 350px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        <header class="text-center mb-10 md:mb-16">
            <h1 class="text-3xl md:text-5xl font-bold text-[#A07D5A] mb-2">Employee Provident Fund (EPF)</h1>
            <p class="text-lg md:text-xl text-gray-600">Your Interactive Guide to Common "How-To" Questions</p>
        </header>

        <main>
            <section id="overview" class="mb-12">
                 <div class="bg-white rounded-xl shadow-lg p-6 md:p-8 grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                    <div class="text-left">
                        <h2 class="text-2xl font-bold text-[#4A4A4A] mb-4">Navigating Your EPF</h2>
                        <p class="text-gray-600 mb-4">
                            The Employee Provident Fund is a crucial savings tool for millions in India. However, managing your account often brings up procedural questions. This guide breaks down the 15 most common "how-to" tasks into simple, manageable categories.
                        </p>
                        <p class="text-gray-600">
                            Use the chart to see which topics people ask about most, then click the tabs below to find detailed, step-by-step answers to your specific questions. Our goal is to make managing your EPF straightforward and stress-free.
                        </p>
                    </div>
                    <div class="chart-container">
                        <canvas id="questionsChart"></canvas>
                    </div>
                </div>
            </section>
            
            <section id="faq-section" class="mb-12">
                <div class="bg-white rounded-xl shadow-lg p-6 md:p-8">
                    <div class="border-b border-gray-200 mb-6">
                        <nav id="tabs" class="-mb-px flex flex-wrap justify-center space-x-2 sm:space-x-4 md:space-x-8 text-sm sm:text-base" aria-label="Tabs">
                        </nav>
                    </div>

                    <div id="tab-content">
                    </div>
                </div>
            </section>

            <section id="gemini-section">
                <div class="bg-white rounded-xl shadow-lg p-6 md:p-8">
                    <h2 class="text-2xl font-bold text-[#4A4A4A] mb-4">✨ Ask Gemini: Get Instant Answers</h2>
                    <p class="text-gray-600 mb-6">
                        Have a question that's not in the guide? Type your query below and our AI assistant will find a grounded answer for you.
                    </p>
                    <div class="flex flex-col md:flex-row gap-4 mb-4">
                        <textarea id="promptInput" class="flex-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#C0A080] resize-none" rows="3" placeholder="e.g., How can I check my EPF claim status without a UAN?"></textarea>
                        <button id="submitButton" class="bg-[#A07D5A] text-white font-semibold py-3 px-6 rounded-lg hover:bg-[#C0A080] transition duration-300 focus:outline-none focus:ring-2 focus:ring-[#C0A080] shrink-0">
                            Get Answer
                        </button>
                    </div>
                    <div id="responseContainer" class="hidden">
                        <div id="loading" class="text-center py-4 hidden">
                            <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12 mb-4 mx-auto"></div>
                            <p class="text-gray-500">Fetching answer...</p>
                        </div>
                        <div id="responseOutput" class="p-4 border border-gray-200 rounded-lg bg-gray-50"></div>
                        <div id="citationLinks" class="mt-4 text-sm text-gray-500"></div>
                        <button id="copyButton" class="bg-gray-200 text-gray-700 font-semibold py-2 px-4 rounded-lg mt-4 hover:bg-gray-300 transition duration-300 focus:outline-none focus:ring-2 focus:ring-gray-400">
                            Copy Answer
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <footer class="text-center mt-12 text-gray-500 text-sm">
            <p>This is an informational tool. Always refer to the official EPFO portal for transactions.</p>
        </footer>
    </div>

    <script>
        const epfData = {
            categories: [
                {
                    name: "Getting Started",
                    id: "getting-started",
                    questions: [
                        {
                            q: "How to generate my UAN online?",
                            a: "You can generate your Universal Account Number (UAN) directly from the EPFO Member Portal. You'll need your Aadhaar number and a linked mobile number to receive an OTP. Visit the portal, click on 'Direct UAN Allotment by Employees', provide your details, and complete the OTP verification."
                        },
                        {
                            q: "How to activate my UAN?",
                            a: "To activate your UAN, go to the EPFO Member Portal and find the 'Activate UAN' link under 'Important Links'. You will need to enter your UAN, Name, Date of Birth, mobile number, and email. After filling in the details and CAPTCHA, you'll receive an authorization PIN on your mobile to complete the activation."
                        },
                        {
                            q: "How to find my UAN if I've forgotten it?",
                            a: "On the EPFO Member Portal login screen, click 'Know your UAN'. You will be asked to enter your mobile number and CAPTCHA to receive an OTP. After verification, you will need to provide your Name, Date of Birth, Aadhaar/PAN/Member ID to retrieve your UAN."
                        }
                    ]
                },
                {
                    name: "Account Management",
                    id: "account-management",
                    questions: [
                        {
                            q: "How to update my KYC details in my EPF account?",
                            a: "Log in to the EPFO Member Portal. Go to the 'Manage' tab and select 'KYC'. You can add or update your Bank, PAN, and Aadhaar details here. Your employer must approve these KYC details before they become active."
                        },
                        {
                            q: "How to link my Aadhaar with my UAN/EPF account?",
                            a: "This is a part of the KYC update process. Log in to the EPFO Member Portal, navigate to 'Manage' > 'KYC', and select the option to add Aadhaar. Enter your Aadhaar number and name. After your employer approves it, it will be linked."
                        },
                         {
                            q: "How to correct my name, date of birth, or other details?",
                            a: "Log in to the EPFO portal and go to 'Manage' > 'Modify Basic Details'. You can enter the correct details as per your Aadhaar. This request will then be sent to your employer for approval. For significant changes, a joint declaration form may be required."
                        },
                        {
                            q: "How to file an e-nomination for my EPF account?",
                            a: "Log in to the portal, go to 'Manage' > 'E-Nomination'. Provide your permanent and current address. Then, add your nominee's details, including Aadhaar, photo, and bank details. You can add multiple nominees and specify the share for each. Finalize by e-signing with your Aadhaar OTP."
                        },
                        {
                            q: "How to update my bank account details?",
                            a: "This is done through the KYC update process. Navigate to 'Manage' > 'KYC' on the member portal. Select 'Bank', enter your new bank account number and IFSC code. This request will need to be approved by your employer."
                        },
                        {
                            q: "How to reset my UAN portal password?",
                            a: "On the EPFO portal login page, click on 'Forgot Password'. You will need to enter your UAN and the CAPTCHA. An OTP will be sent to your registered mobile number, which you can use to set a new password."
                        }
                    ]
                },
                {
                    name: "Money Movements",
                    id: "money-movements",
                    questions: [
                        {
                            q: "How to withdraw my EPF amount online (Final Settlement)?",
                            a: "For final withdrawal (after leaving a job), you must have an active UAN, linked Aadhaar, and updated KYC. Log in to the portal, go to 'Online Services' > 'Claim (Form-31, 19, 10C & 10D)'. Verify your bank account. Select 'Only PF Withdrawal (Form 19)'. Your request will be processed after employer verification."
                        },
                        {
                            q: "How to withdraw EPF for specific purposes (Partial Withdrawal)?",
                            a: "The process is similar to final withdrawal. In the 'Claim' section, select 'PF Advance (Form 31)'. You will need to choose the reason for the advance (e.g., housing, marriage, medical) and provide the required amount and documents (like scanned cheque/passbook)."
                        },
                        {
                            q: "How to transfer my EPF account to a new employer?",
                            a: "Once you join a new company and they create a new Member ID under your UAN, you can initiate a transfer. Log in to the portal, go to 'Online Services' > 'One Member – One EPF Account (Transfer Request)'. Verify your personal information and details of your previous account, then authenticate the request with an OTP."
                        }
                    ]
                },
                {
                    name: "Information & Claims",
                    id: "info-claims",
                    questions: [
                         {
                            q: "How to check my EPF balance?",
                            a: "There are four main ways: 1. Log in to the EPFO Member Portal to view your passbook. 2. Use the UMANG App. 3. Send an SMS with 'EPFOHO UAN ENG' to 7738299899. 4. Give a missed call to 9966044425 from your registered mobile number."
                        },
                        {
                            q: "How to download my EPF passbook?",
                            a: "Log in to the EPFO Member e-Sewa portal. Go to 'View' > 'Passbook'. You will be redirected to the passbook portal where you need to log in again with your UAN and password. From there, you can view and download the passbook for your member IDs."
                        },
                        {
                            q: "How to check the status of my EPF claim or transfer?",
                            a: "After logging into the portal, go to 'Online Services' > 'Track Claim Status'. You will see a history of all your online withdrawal and transfer claims, along with their current status (e.g., submitted, approved, settled)."
                        }
                    ]
                }
            ]
        };

        document.addEventListener('DOMContentLoaded', function() {
            const tabsContainer = document.getElementById('tabs');
            const tabContentContainer = document.getElementById('tab-content');

            epfData.categories.forEach((category, index) => {
                const tabButton = document.createElement('button');
                tabButton.textContent = category.name;
                tabButton.className = `px-3 py-2 font-medium text-center border-b-2 transition duration-300 ease-in-out ${index === 0 ? 'tab-active' : 'tab-inactive'}`;
                tabButton.dataset.target = category.id;
                tabsContainer.appendChild(tabButton);

                const contentDiv = document.createElement('div');
                contentDiv.id = category.id;
                contentDiv.className = index === 0 ? '' : 'hidden';
                
                const accordionContainer = document.createElement('div');
                accordionContainer.className = 'space-y-4';

                category.questions.forEach(item => {
                    const accordionItem = document.createElement('div');
                    accordionItem.className = 'accordion-item border border-gray-200 rounded-lg';
                    
                    const header = document.createElement('button');
                    header.className = 'accordion-header flex justify-between items-center w-full p-4 text-left font-medium text-gray-700 focus:outline-none';
                    header.innerHTML = `
                        <span>${item.q}</span>
                        <span class="accordion-arrow text-[#C0A080] transform">▼</span>
                    `;
                    
                    const content = document.createElement('div');
                    content.className = 'accordion-content';
                    content.innerHTML = `<div class="p-4 border-t border-gray-200 text-gray-600 bg-gray-50 rounded-b-lg">${item.a}</div>`;
                    
                    accordionItem.appendChild(header);
                    accordionItem.appendChild(content);
                    accordionContainer.appendChild(accordionItem);
                });
                
                contentDiv.appendChild(accordionContainer);
                tabContentContainer.appendChild(contentDiv);
            });

            tabsContainer.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    const targetId = e.target.dataset.target;
                    
                    tabsContainer.querySelectorAll('button').forEach(btn => {
                        btn.className = btn.className.replace('tab-active', 'tab-inactive');
                    });
                    
                    e.target.className = e.target.className.replace('tab-inactive', 'tab-active');
                    
                    tabContentContainer.querySelectorAll('div[id]').forEach(content => {
                        content.classList.add('hidden');
                    });
                    
                    document.getElementById(targetId).classList.remove('hidden');
                }
            });

            tabContentContainer.addEventListener('click', (e) => {
                const header = e.target.closest('.accordion-header');
                if (header) {
                    const item = header.parentElement;
                    item.classList.toggle('open');
                }
            });

            const ctx = document.getElementById('questionsChart').getContext('2d');
            const chartData = {
                labels: epfData.categories.map(c => c.name),
                datasets: [{
                    label: 'Number of Questions',
                    data: epfData.categories.map(c => c.questions.length),
                    backgroundColor: [
                        '#D3B89A',
                        '#E4CDB6',
                        '#C0A080',
                        '#A07D5A'
                    ],
                    borderColor: '#FDFBF8',
                    borderWidth: 3,
                    hoverOffset: 4
                }]
            };

            new Chart(ctx, {
                type: 'doughnut',
                data: chartData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#4A4A4A',
                                font: {
                                    size: 14,
                                    family: 'Inter'
                                }
                            }
                        },
                        tooltip: {
                             callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += context.parsed + ' questions';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    cutout: '60%'
                }
            });

            const submitButton = document.getElementById('submitButton');
            const promptInput = document.getElementById('promptInput');
            const loadingIndicator = document.getElementById('loading');
            const responseContainer = document.getElementById('responseContainer');
            const responseOutput = document.getElementById('responseOutput');
            const citationLinks = document.getElementById('citationLinks');
            const copyButton = document.getElementById('copyButton');

            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const handleApiRequest = async () => {
                const userPrompt = promptInput.value.trim();
                if (!userPrompt) {
                    return;
                }

                submitButton.disabled = true;
                loadingIndicator.classList.remove('hidden');
                responseContainer.classList.remove('hidden');
                responseOutput.textContent = '';
                citationLinks.innerHTML = '';
                copyButton.classList.add('hidden');

                const systemPrompt = "You are an expert on the Employee Provident Fund (EPF) in India. Provide concise, step-by-step answers to 'how-to' questions. Be helpful and informative.";
                const payload = {
                    contents: [{ parts: [{ text: userPrompt }] }],
                    tools: [{ "google_search": {} }],
                    systemInstruction: { parts: [{ text: systemPrompt }] },
                };

                let retries = 0;
                const maxRetries = 3;
                let delay = 1000;

                while (retries < maxRetries) {
                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            if (response.status === 429) {
                                throw new Error('Rate limit exceeded');
                            }
                            throw new Error(`API error: ${response.statusText}`);
                        }

                        const result = await response.json();
                        const candidate = result.candidates?.[0];
                        
                        if (candidate && candidate.content?.parts?.[0]?.text) {
                            const text = candidate.content.parts[0].text;
                            responseOutput.textContent = text;
                            copyButton.classList.remove('hidden');

                            let sources = [];
                            const groundingMetadata = candidate.groundingMetadata;
                            if (groundingMetadata && groundingMetadata.groundingAttributions) {
                                sources = groundingMetadata.groundingAttributions
                                    .map(attribution => ({
                                        uri: attribution.web?.uri,
                                        title: attribution.web?.title,
                                    }))
                                    .filter(source => source.uri && source.title);
                            }

                            if (sources.length > 0) {
                                citationLinks.innerHTML = '<p class="font-bold mt-2">Sources:</p>';
                                sources.forEach(source => {
                                    const link = document.createElement('a');
                                    link.href = source.uri;
                                    link.textContent = source.title;
                                    link.target = "_blank";
                                    link.className = "block text-blue-600 hover:underline mb-1";
                                    citationLinks.appendChild(link);
                                });
                            }
                        } else {
                            responseOutput.textContent = "Sorry, I couldn't generate an answer for that. Please try rephrasing your question.";
                        }
                        break;
                    } catch (error) {
                        retries++;
                        if (retries < maxRetries) {
                            await new Promise(res => setTimeout(res, delay));
                            delay *= 2;
                        } else {
                            responseOutput.textContent = `Error: ${error.message}. Please try again later.`;
                        }
                    }
                }

                loadingIndicator.classList.add('hidden');
                submitButton.disabled = false;
            };

            submitButton.addEventListener('click', handleApiRequest);
            promptInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter' && !event.shiftKey) {
                    event.preventDefault();
                    handleApiRequest();
                }
            });

            copyButton.addEventListener('click', () => {
                const textToCopy = responseOutput.textContent;
                navigator.clipboard.writeText(textToCopy).then(() => {
                    const originalText = copyButton.textContent;
                    copyButton.textContent = 'Copied!';
                    setTimeout(() => {
                        copyButton.textContent = originalText;
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy text: ', err);
                });
            });

        });
    </script>
</body>
</html>
